---
title: "JH paper RNAseq data "
author: "Yang Lyu"
date: "`r Sys.Date()`"
output:
  pdf_document:
    keep_tex: true
    latex_engine: pdflatex
    fig_caption: yes
    highlight: haddock
    number_sections: yes
    #latex_engine: xelatex

knit: (
  function(inputFile, encoding) { 
      pSubTitle <- paste(Sys.Date(), "JH paper RNAseq data" )
     
    rmarkdown::render( 
      input       = inputFile, 
      encoding    = encoding, 
      params      = list(sub_title = pSubTitle),      
      output_file = pSubTitle,
      output_dir="/Volumes/lyu.yang/MAC_1/R/Project/11_JH_biobank_paper/Output/RNAseq" ) 
       }
       
       )
      
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo =F,message = F,warning = F)
```


# RNAseq data loading
```{r,include=F}
getwd()
rm(list=ls())
#dir.create("/Volumes/lyu.yang/MAC_1/R/Project/10_JH-2002-shURB5/Output")
Path="/Volumes/lyu.yang/MAC_1/R/Project/11_JH_biobank_paper"
Rcode_path=file.path(Path,"Rcode")
Rdata_path=file.path(Path,"Rdata")
Rawdata_path=file.path(Path,"Rawdata")
dir.create(Rawdata_path)
Public_database_path="/Volumes/lyu.yang/MAC_1/R/Public_database"
dir(Public_database_path)
dir.create(Rdata_path)
dir.create(Rawdata_path)
library(dplyr)
library(ggplot2)
 
```

```{r}
R_function_path="/Volumes/lyu.yang/MAC_1/R/Public_database/R_function"
Reference_path="/Volumes/lyu.yang/MAC_1/R/Public_database/Reference"

source( file.path(R_function_path, "RNAseq_pipeline.R"))
```

```{r}
All_sample_anno=readxl::read_excel("/Volumes/lyu.yang/MAC_1/R/Project/NTAP/Rawdata/Sample_annotation/Round4/Round1_4_annotation_03262023.xlsx") 

JH_paper_anno_RNAseq=All_sample_anno %>%dplyr::filter(batch!="WU_batch3") %>%dplyr::filter(grepl("RNA",Assay))%>%dplyr::filter(grepl("tumor|blood", tissue))%>%mutate(RNA_ID2=gsub("\\.","-",RNA_ID))

```

```{r}
RNAseq_path="/Volumes/H_Drive_3/JH_biobank_RNAseq_Synapse"
Merge_couts=list.files(RNAseq_path,pattern = "salmon.merged.gene_counts.tsv",recursive = T,full.names = T)

Gene_name=readr::read_tsv(Merge_couts[1])%>%.$gene_name

Count_list=list()
for (i in Merge_couts){
  Batch=stringr::str_split(i,"/")%>%unlist()%>%.[grepl("batch",.)]
  data=readr::read_tsv(i)
  data2=data[,3:ncol(data)]%>%as.data.frame()
  colnames(data2)=gsub("\\.","-",colnames(data2))
  rownames(data2)=data$gene_id
  Count_list[[Batch]]=data2

}

Count_all=do.call("cbind" ,Count_list)
#
Coumnt_sample=data.frame(RNAseq_ID=colnames(Count_all)) %>%  tidyr::separate(RNAseq_ID,c("batch","RNA_ID2"),sep="\\.",remove=F)%>%dplyr::filter(batch!="WU_batch3")%>%
mutate(RNA_ID2=gsub("X","", RNA_ID2))%>%  right_join(.,JH_paper_anno_RNAseq,by="RNA_ID2")
Coumnt_sample$parentBiospecimenID[duplicated(Coumnt_sample$parentBiospecimenID)]

Count_all_clean=Count_all %>%.[,Coumnt_sample$RNAseq_ID]

Parent_ID=Coumnt_sample %>%.[match(colnames(Count_all_clean),.$RNAseq_ID),]

Parent_ID$RNAseq_ID==colnames(Count_all_clean)
Count_all_clean_rename=Count_all_clean
colnames(Count_all_clean_rename)=Parent_ID$parentBiospecimenID

dir.create(file.path(Rawdata_path, "RNAseq"))
write.csv(Count_all_clean_rename,file=file.path(Rawdata_path, "RNAseq","52_JH_Tumor_raw_counts.csv"))

#write.csv(Coumnt_sample,file=file.path(Rawdata_path,"52_JH_Tumor_proteincoding_salmon_counts.csv"))
Coumnt_sample_clean=Coumnt_sample%>%mutate(File_name=parentBiospecimenID)%>%select(-batch.x)%>%rename(batch="batch.y")%>%mutate(batch=gsub("WU_batch1&","",batch))
Coumnt_sample_clean2=Coumnt_sample_clean[,c(24,1:18)]%>%select(-RNA_ID2)

Coumnt_sample_clean2$File_name==colnames(Count_all_clean_rename)

setdiff(colnames(Count_all_clean_rename), Coumnt_sample_clean2$File_name)
write.csv(Coumnt_sample_clean2,file=file.path(Rawdata_path,"RNAseq","52_JH_Tumor_RNAseq_annotation.csv"))

Count_all_clean_rename_rm_dup=Count_all_clean_rename %>%mutate(gene_name=Gene_name) %>% subset(gene_name%in% Protein_coding_genelist) %>% group_by(gene_name) %>%summarise_all(mean)%>%as.data.frame()%>%matrix.please()

write.csv(Count_all_clean_rename_rm_dup,file=file.path(Rawdata_path,"RNAseq","52_JH_Tumor_proteincoding_salmon_counts.csv"))
```


```{r}
Rawcounts=read.csv(file.path(Rawdata_path,"RNAseq","52_JH_Tumor_raw_counts.csv"),row.names = 1,check.names = F)
Protein_coding_counts=read.csv(file.path(Rawdata_path,"RNAseq","52_JH_Tumor_proteincoding_salmon_counts.csv"),row.names = 1,check.names = F)
RNAseq_anno=read.csv(file.path(Rawdata_path,"RNAseq","52_JH_Tumor_RNAseq_annotation.csv"),row.names = 1,check.names = F)
RNAseq_anno$batch=factor(RNAseq_anno$batch,c("JH_batch1" ,"WU_batch1","WU_batch2","WU_PDX_batch1","WU_PDX_batch2"))

Disease_sum=RNAseq_anno%>%group_by(tumorType)%>%summarise(n=n())

```

# Batch effect 
## Raw data batch effect
```{r}
Tumor_count_log=log2(Protein_coding_counts+1)

PCA_Plot_3  (t(Tumor_count_log),RNAseq_anno,"File_name","batch")

Batch_count_plot(Tumor_count_log,RNAseq_anno)

```



## Batch effect was removed by normalization
 
```{r,eval=T}
#groups = sapply(as.character(GTAC_Sample_anno$Disease), switch, "PN" = 1, "MPNST" = 2,  USE.NAMES = F)
batches = sapply(as.character(RNAseq_anno$batch), switch, "WU_PDX_batch1"=4,"WU_PDX_batch2"=5, "WU_batch1" = 2, "WU_batch2" = 3,"JH_batch1"=1,USE.NAMES = F)
# mod = model.matrix(~as.factor(Disease), data=GTAC_Sample_anno)
#now run ComBat_seq
#GTAC_count_clean_log=log2(GTAC_count_clean+1)
#BiocManager::install("sva")
corrected_data = sva::ComBat(Tumor_count_log,batch =RNAseq_anno$batch,par.prior=T, mean.only = F)

#combat_edata = ifelse(corrected_data<0,0,corrected_data)
#corrected_data_log=log2(corrected_data+1)%>%na.omit()
```


```{r,eval=T}
PCA_Plot_3  (t(corrected_data),RNAseq_anno,"File_name","batch")
#PCA_Plot_3  (t(corrected_data),RNAseq_anno,"File_name","tissueType")
PCA_Plot_3  (t(corrected_data),RNAseq_anno,"File_name","tumorType")
```

```{r}
Batch_count_plot(corrected_data,RNAseq_anno)
```

# 14 MPNST vs 30 PN (normalized counts, DEseq2)

```{r}
GTAC_Sample_anno=RNAseq_anno %>%mutate(Group=Disease) %>%mutate(Sample_name=File_name)
GTAC_Sample_anno$Group=factor(GTAC_Sample_anno$Group,levels=c("PN","cNF","DifNF","NodNF","MPNST"  ))
rownames(GTAC_Sample_anno)=GTAC_Sample_anno$Sample_name
colnames(corrected_data)==GTAC_Sample_anno$Sample_name
corrected_data_counts=2^(corrected_data) %>%round(.,0)
MPNST_vs_NF_Deseq=Deseq2_Deseq_function_2(corrected_data_counts,GTAC_Sample_anno)
DESeq2::resultsNames(MPNST_vs_NF_Deseq)
#"Group_MPNST_vs_PN"
MPNST_vs_PN_res <- DESeq2::results(MPNST_vs_NF_Deseq, name = "Group_MPNST_vs_PN", alpha = 0.05) %>%as.data.frame()
MPNST_vs_PN_res_q005=MPNST_vs_PN_res %>%dplyr::filter(padj<0.05)
MPNST_vs_PN_res_q005_up=MPNST_vs_PN_res_q005 %>%dplyr::filter(log2FoldChange>0)%>%arrange(desc(log2FoldChange))

MPNST_vs_PN_res_q005_DN=MPNST_vs_PN_res_q005 %>%dplyr::filter(log2FoldChange<0)%>%arrange(log2FoldChange)
#
Expression_vst=Deseq_vst(corrected_data_counts,GTAC_Sample_anno)
Expression_vst_anno=t(Expression_vst) %>%as.data.frame() %>%tibble::rownames_to_column (.,var="Sample_name" ) %>%left_join(.,GTAC_Sample_anno)%>% arrange(Group,Sample_name)
rownames(Expression_vst_anno)=Expression_vst_anno$Sample_name

Expression_vst_anno_MPNST_PN=Expression_vst_anno%>%.[grepl("PN|MPNST",.$Sample_name) ,]
Expression_vst_MPNST_PN=Expression_vst[,rownames(Expression_vst_anno_MPNST_PN)]
MPNST_vs_PN_res_2=MPNST_vs_PN_res%>%mutate(gene_symbol=rownames(.))
#save(GTAC_Sample_anno,MPNST_vs_PN_res_q005,Expression_vst_anno_MPNST_PN,Expression_vst_MPNST_PN,MPNST_vs_PN_res,MPNST_vs_PN_res_2 ,file=file.path(Rawdata_path,"RNAseq","MPNST_VS_PN_res.rdata"))

#cgwtools::resave(MPNST_vs_PN_res_q005,file=file.path(Rawdata_path,"RNAseq","MPNST_VS_PN_res.rdata") )
```




```{r}
Reference_path="/Volumes/lyu.yang/MAC_1/R/Public_database/Reference"
res_q005_rank=MPNST_vs_PN_res_q005%>%arrange(log2FoldChange) %>%.[c("log2FoldChange")]%>%as.data.frame() %>%tibble::rownames_to_column()
GMT_files=list.files(file.path(Reference_path,"Human_GSEA"),pattern="all.v7.5.1.symbols.gmt.txt",full.names = T)
res_q005_rank=MPNST_vs_PN_res_q005%>%arrange(log2FoldChange) %>%.[c("log2FoldChange")]%>%as.data.frame() %>%tibble::rownames_to_column()
ranks <- tibble::deframe(res_q005_rank)
All_pathway=fgsea::gmtPathways(file.path(Reference_path,"Human_GSEA","msigdb.v7.5.1.symbols.gmt.txt"))
fgseaRes <- fgsea::fgseaMultilevel(All_pathway, ranks,
                           minSize=20,
                           maxSize=500
                           )

Hallmark=fgseaRes %>%dplyr::filter(grepl("HALLMARK",pathway )) %>%  arrange(padj)
Hallmark_q005=Hallmark%>%dplyr::filter(padj<0.05)%>% arrange(desc(NES))
Hallmark_EMT=Hallmark%>%dplyr::filter(pathway=="HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION")

knitr::kable(Hallmark_q005[,c(1,2,3,6)],caption = "Hallmark pathways changed in shUBR5 groups (vs contral,padj<0.05)") %>%kableExtra::kable_styling(latex_options = c("hold_position"))


fgsea_list=list()
for (i in GMT_files){
 name=gsub(".*/","",i)
 name2=gsub("all.v7.5.1.symbols.gmt.txt","",name)
 pathway= fgsea::gmtPathways(i)
 fgseaRes <- fgsea::fgseaMultilevel(pathway, ranks,
                           minSize=10,
                           maxSize=500
                           )
 fgsea_list[[name2]]=fgseaRes

}
```

```{r}
All_pathway_singscore=do.call("rbind", fgsea_list)
# cgwtools::resave(All_pathway_singscore,file=file.path(Rawdata_path,"RNAseq","MPNST_VS_PN_res.rdata"))
All_pathway_singscore_q005=do.call("rbind", fgsea_list)%>%dplyr::filter(padj<0.05)
# cgwtools::resave(All_pathway_singscore_q005,file=file.path(Rawdata_path,"RNAseq","MPNST_VS_PN_res.rdata"))
#load(file.path(Rawdata_path,"RNAseq","MPNST_VS_PN_res.rdata"))#MPNST_vs_PN_res_q005,Expression_vst_anno_MPNST_PN MPNST_vs_PN_res_q005,Expression_vst_anno_MPNST_PN,Expression_vst_MPNST_PN,MPNST_vs_PN_res,MPNST_vs_PN_res_2
#cgwtools::lsdata(file.path(Rawdata_path,"RNAseq","MPNST_VS_PN_res.rdata"))
MPNST_PN_sample=data.frame(File_name=colnames(Expression_vst_MPNST_PN))%>%left_join(.,GTAC_Sample_anno[,c("File_name","individualID","age","location","tumorType")])
knitr::kable(MPNST_PN_sample,caption = "PN and MPNST sample list")%>% kableExtra::kable_styling(latex_options = c("scale_down" ))
```

```{r}

key_words_enrichment=Pathway_enrichment_analysis(All_pathway_singscore_q005$pathway,5)
Int_key_words=c("H3K27ME3","P53","TP53","IL4","IL12","TGFB","TNF","MESENCHYMAL","APOPTOSIS","CYCLE","METASTASIS","MITOTIC","STROMAL","EPITHELIAL","MESENCHYMAL","AKT","PI3K","PATHWAY","MYC","EGFR","ERBB","WNT","JNK","P38","RHO","ARF","PDGF","GROWTH_FACTOR","MHC")
Key_pathway=do.call("rbind", Pathway_select_by_keyword(All_pathway_singscore_q005$pathway,Int_key_words) ) %>%as.data.frame() %>%setNames("Keyword") %>%
       mutate(Keyword=gsub("TP53","P53" ,Keyword)) %>%arrange(Keyword)


Key_pathway_anno=All_pathway_singscore_q005 %>%.[.$pathway%in% rownames(Key_pathway) ,] %>%.[,c("pathway","padj","NES")]
```
## Top 20 exprssed genes
```{r}
q005_gene=rownames(MPNST_vs_PN_res_q005)
Expression_vst_anno_MPNST_PN_q005=Expression_vst_anno_MPNST_PN[,c("Sample_name",q005_gene)]
Expression_vst_MPNST_PN_q005=Expression_vst_MPNST_PN[q005_gene,]

Top20_up_genes=MPNST_vs_PN_res_q005%>%arrange(desc(log2FoldChange))%>%.[1:20,]
Down20_up_genes=MPNST_vs_PN_res_q005%>%arrange(log2FoldChange)%>%.[1:20,]

knitr::kable(Top20_up_genes[,c(2,5,6)],caption = "Top 20 Upregulated genes (MPNST vs PN) " ) %>%kableExtra::kable_styling()
knitr::kable(Down20_up_genes[,c(2,5,6)],caption = "Top 20 Downregulated genes (MPNST vs PN) " ) %>%kableExtra::kable_styling(latex_options = c("hold_position"))

```

# Significant pathways
```{r}
Sig_pathways=c("MEISSNER_BRAIN_HCP_WITH_H3K27ME3","FISCHER_G2_M_CELL_CYCLE" ,"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION" ,"WINNEPENNINCKX_MELANOMA_METASTASIS_UP")
knitr::kable(Key_pathway_anno[Key_pathway_anno$pathway%in%Sig_pathways,],caption = "Significant pathways in MPNST (vs PN) " ) %>%kableExtra::kable_styling(latex_options = c("hold_position"))
```

\newpage
## MPNST markers

**S100B, CNP,PMP22,ngfr ,Expression of Schwann cell differentiation markers Downregulaed in MPNST** \t
**TWIST1,SOX9,SOX10  ,stem cell marker, upregulated in MPNST"**
**E-cadherin (CDH1) was downregulated in both neurofibroma and MPNSTs**
**GAS1 (Growth Arrest Specific 1) is a Protein Coding gene. IFG2, PTK7, FGFR1, TWIST1, GAS1, and EGFR.upregulated in MPNST**

```{r}
MPNST_markers= c( "UBR5","TP53", "CNP","PMP22","NGFR","SOX9","SOX10","S100B","S100A4", "S100A1", "S100A2", "S100A6","CCNB2","TWIST1","EGFR","FGFR1","ERBB3","ERBB2","COL6A3","CDH1","CDKN2A","PDGFA","PDGFB","TGFBR2","GAS1","TGFB1","TGFB2","IGF2","PTK7")

Pathway_list=list("MPNST_markers"=MPNST_markers)

Stat_method="wilcox.test"
gene_list2=data.frame(Pathway=MPNST_markers)
colnames(Expression_vst_MPNST_PN_q005)==MPNST_PN_sample$File_name

Output=Singscore_data_plot_2(gene_list2,Expression_vst_MPNST_PN_q005,Expression_vst_anno_MPNST_PN_q005,GTAC_Sample_anno,Stat_method)


```

```{r}
Valcano_plot_rnaseq (MPNST_vs_PN_res_2,Pathway_list,"MPNST_markers")
```
 

```{r,include=F ,fig.height=35,fig.width=18,out.height="95%"}
Compare_list=list(c("MPNST","PN"))
setdiff(MPNST_markers,colnames(Expression_vst_anno_MPNST_PN))

res_2=MPNST_vs_PN_res%>%mutate(group1="MPNST",group2="PN")
Batch_boxplot_4(MPNST_markers,res_2,Expression_vst_anno_MPNST_PN,x_name="Group",fillby="Group",nCol=4,Compare_list=Compare_list,"Normalized_counts")
```

\newpage

## MEISSNER BRAIN HCP WITH H3K27ME3

```{r,fig.height=8,fig.width=6,out.height="80%"}
Pathway="MEISSNER_BRAIN_HCP_WITH_H3K27ME3"
Stat_method="wilcox.test"
gene_list2=GSEA_pathway_list[[Pathway]]%>%as.data.frame() %>%setNames(Pathway)
Heatmap_simple(gene_list2,Expression_vst_MPNST_PN_q005,Expression_vst_anno_MPNST_PN_q005,GTAC_Sample_anno)

```


```{r,fig.height=16,fig.width=10,out.height="80%"}
Output=Singscore_data_plot_2(gene_list2,Expression_vst_MPNST_PN_q005,Expression_vst_anno_MPNST_PN_q005,GTAC_Sample_anno,Stat_method)

```
\newpage
```{r}
Output[[1]]
Valcano_plot_rnaseq (MPNST_vs_PN_res_2,GSEA_pathway_list,Pathway)

```

## FISCHER G2 M CELL CYCLE

```{r,fig.height=8,fig.width=6}
Pathway="FISCHER_G2_M_CELL_CYCLE" 
Stat_method="wilcox.test"
gene_list2=GSEA_pathway_list[[Pathway]]%>%as.data.frame() %>%setNames(Pathway)
Heatmap_simple(gene_list2,Expression_vst_MPNST_PN_q005,Expression_vst_anno_MPNST_PN_q005,GTAC_Sample_anno)

```


```{r,fig.height=12,fig.width=8}
Output=Singscore_data_plot_2(gene_list2,Expression_vst_MPNST_PN_q005,Expression_vst_anno_MPNST_PN_q005,GTAC_Sample_anno,Stat_method)
```
\newpage

```{r}
Output[[1]]
Valcano_plot_rnaseq (MPNST_vs_PN_res_2,GSEA_pathway_list,Pathway)

```

## HALLMARK EPITHELIAL MESENCHYMAL TRANSITION

```{r,fig.height=8,fig.width=6}
Pathway="HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION" 
Stat_method="wilcox.test"
gene_list2=GSEA_pathway_list[[Pathway]]%>%as.data.frame() %>%setNames(Pathway)
Heatmap_simple(gene_list2,Expression_vst_MPNST_PN_q005,Expression_vst_anno_MPNST_PN_q005,GTAC_Sample_anno)

```


```{r,fig.height=12,fig.width=8}
Output=Singscore_data_plot_2(gene_list2,Expression_vst_MPNST_PN_q005,Expression_vst_anno_MPNST_PN_q005,GTAC_Sample_anno,Stat_method)
```

\newpage

```{r}
Output[[1]]
Valcano_plot_rnaseq (MPNST_vs_PN_res_2,GSEA_pathway_list,Pathway)

```

## WINNEPENNINCKX MELANOMA METASTASIS UP


```{r,fig.height=8,fig.width=6}
Pathway="WINNEPENNINCKX_MELANOMA_METASTASIS_UP" 
Stat_method="wilcox.test"
gene_list2=GSEA_pathway_list[[Pathway]]%>%as.data.frame() %>%setNames(Pathway)
Heatmap_simple(gene_list2,Expression_vst_MPNST_PN_q005,Expression_vst_anno_MPNST_PN_q005,GTAC_Sample_anno)

```


```{r,fig.height=12,fig.width=8}
Output=Singscore_data_plot_2(gene_list2,Expression_vst_MPNST_PN_q005,Expression_vst_anno_MPNST_PN_q005,GTAC_Sample_anno,Stat_method)

```


```{r}
Output[[1]]
Valcano_plot_rnaseq (MPNST_vs_PN_res_2,GSEA_pathway_list,Pathway)

```


\newpage

## MAPK/AKT PATHWAY

### WP_PI3KAKT_SIGNALING_PATHWAY
```{r,fig.height=8,fig.width=6}
MAPK_AKT=All_pathway_singscore%>%dplyr::filter(grepl("MAPK|AKT|AMPK|MTOR",pathway ))
Pathway="WP_PI3KAKT_SIGNALING_PATHWAY" 
Stat_method="wilcox.test"
gene_list2=GSEA_pathway_list[[Pathway]]%>%as.data.frame() %>%setNames(Pathway)
Output=Singscore_data_plot_2(gene_list2,Expression_vst_MPNST_PN_q005,Expression_vst_anno_MPNST_PN_q005,GTAC_Sample_anno,Stat_method)

```
\newpage

```{r}
Output[[1]]
Valcano_plot_rnaseq (MPNST_vs_PN_res_2,GSEA_pathway_list,Pathway)
```
\newpage

### REACTOME_PI3K_AKT_SIGNALING_IN_CANCER
```{r,fig.height=4,fig.width=6}
Pathway="REACTOME_PI3K_AKT_SIGNALING_IN_CANCER" 
Stat_method="wilcox.test"
gene_list2=GSEA_pathway_list[[Pathway]]%>%as.data.frame() %>%setNames(Pathway)
Output=Singscore_data_plot_2(gene_list2,Expression_vst_MPNST_PN_q005,Expression_vst_anno_MPNST_PN_q005,GTAC_Sample_anno,Stat_method)

```
\newpage

```{r}
Output[[1]]
Valcano_plot_rnaseq (MPNST_vs_PN_res_2,GSEA_pathway_list,Pathway)
```

\newpage

### WP_MAPK_SIGNALING_PATHWAY


```{r,fig.height=6,fig.width=6}
Pathway="WP_MAPK_SIGNALING_PATHWAY" 
Stat_method="wilcox.test"
gene_list2=GSEA_pathway_list[[Pathway]]%>%as.data.frame() %>%setNames(Pathway)
Output=Singscore_data_plot_2(gene_list2,Expression_vst_MPNST_PN_q005,Expression_vst_anno_MPNST_PN_q005,GTAC_Sample_anno,Stat_method)

```
\newpage

```{r}
Output[[1]]
Valcano_plot_rnaseq (MPNST_vs_PN_res_2,GSEA_pathway_list,Pathway)
```

### HALLMARK_MTORC1_SIGNALING
```{r,fig.height=6,fig.width=6}
Pathway="HALLMARK_MTORC1_SIGNALING" 
Stat_method="wilcox.test"
gene_list2=GSEA_pathway_list[[Pathway]]%>%as.data.frame() %>%setNames(Pathway)
Output=Singscore_data_plot_2(gene_list2,Expression_vst_MPNST_PN_q005,Expression_vst_anno_MPNST_PN_q005,GTAC_Sample_anno,Stat_method)

```


\newpage

```{r}
Output[[1]]
Valcano_plot_rnaseq (MPNST_vs_PN_res_2,GSEA_pathway_list,Pathway)
```

```{r}
knitr::knit_exit()
```


